<!-- ASIAGOLD UI v0.4.5 | Stage 2b: khorderiz row-based detail -->
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asia Gold | داشبورد کاربر</title>
<link rel="stylesheet" href="./theme.css">
<style>
.wrapper{align-items:center;}
.card{
  max-width:430px;
  padding:22px;
}
.header{margin-bottom:16px;}
.logo{
  width:92px;height:92px;margin:0 auto 10px;
  font-size:16px;
}
.title{font-size:16px;font-weight:bold;color:var(--text2);}
.sub{font-size:13px;color:var(--text3);margin-top:4px;}
.status{
  margin-top:14px;border-radius:var(--r18);padding:12px;text-align:center;
  background:linear-gradient(180deg,var(--glass-strong),var(--glass-soft));
  color:var(--success);font-size:13px;
}
.grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:18px;}
.item{
  border-radius:var(--r18);padding:14px;
  background:linear-gradient(180deg,var(--glass-strong),var(--glass-soft));
  display:flex;justify-content:space-between;align-items:center;
}
.item span{color:var(--accent-light);font-weight:600;font-size:14px;}
.item button,
.item a{
  border:none;border-radius:14px;padding:10px 14px;
  background:linear-gradient(135deg,var(--gold4),var(--gold6));
  color:var(--ink4);font-weight:bold;font-size:13px;cursor:pointer;
  text-decoration:none;display:inline-block;text-align:center;
}
.item a.cart-action{display:inline-flex;align-items:center;gap:6px;}
.catalog{
  margin-top:16px;
  border-radius:var(--r18);
  padding:14px;
  background:linear-gradient(180deg,var(--glass-strong),var(--glass-soft));
}
.catalog-head{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;}
.catalog-title{color:var(--accent-light);font-weight:700;font-size:14px;}
.catalog-breadcrumb{margin-top:6px;color:var(--text5);font-size:12px;line-height:1.7;}
.catalog-back{
  border:none;border-radius:14px;padding:10px 14px;
  background:linear-gradient(135deg,var(--gold4),var(--gold6));
  color:var(--ink4);font-weight:bold;font-size:13px;cursor:pointer;
  white-space:nowrap;
}
.catalog-list{
  margin-top:12px;
  display:flex;flex-direction:column;gap:10px;
  max-height:320px;overflow:auto;padding:2px;
}
.catalog-item{
  width:100%;
  border:none;
  border-radius:var(--r18);
  padding:12px;
  background:linear-gradient(180deg,var(--glass-strong),var(--glass-soft));
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:12px;
  direction:ltr;
  text-align:right;
}
.catalog-thumb{
  width:52px;height:52px;border-radius:14px;
  background:radial-gradient(circle at top,var(--gold1),var(--gold2),var(--gold3));
  display:flex;align-items:center;justify-content:center;
  color:var(--ink1);font-weight:800;flex-shrink:0;
}
.catalog-text{flex:1;direction:rtl;text-align:right;}
.catalog-name{color:var(--text2);font-weight:800;font-size:14px;line-height:1.5;}
.catalog-desc{margin-top:4px;color:var(--text5);font-size:12px;line-height:1.7;}
.footer{margin-top:18px;}
</style>
</head>
<body>
<header class="ag-topbar" role="banner">
  <button class="ag-back" type="button" data-fallback="./user-dashboard.html" aria-label="بازگشت">
    <span class="ag-back-icon" aria-hidden="true">←</span>
  </button>
  <div class="ag-topbar-title" id="ag-topbar-title"></div>
  <div aria-hidden="true"></div>
</header>
<div class="wrapper">
  <div class="card">
    <div class="header">
      <div class="logo-ring">
        <div class="logo">Asia<br>Gold</div>
      </div>
      <div class="title">داشبورد مشتری</div>
      <div class="sub">بدون پرداخت • فقط ثبت درخواست و پیگیری وضعیت</div>
    </div>

    <div class="status">پرداختی لازم نیست؛ این پلتفرم فقط واسطه بین کارخانه و مشتری است</div>

    <div class="catalog" id="catalog">
      <div class="catalog-head">
        <div>
          <div class="catalog-title">کاتالوگ محصولات</div>
          <div class="catalog-breadcrumb" id="catalog-breadcrumb">برای شروع، یک «دسته‌بندی» را انتخاب کنید.</div>
        </div>
        <button class="catalog-back" type="button" id="catalog-back" hidden>بازگشت</button>
      </div>
      <div class="catalog-list" id="catalog-list" aria-live="polite"></div>
    </div>

    <div class="grid">
      <div class="item"><span>ثبت درخواست سفارش</span><a href="./user-orders.html#new-order">شروع</a></div>
      <div class="item"><span>پیگیری سفارش‌ها</span><a href="./user-orders.html" class="cart-action">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
             xmlns="http://www.w3.org/2000/svg">
          <path d="M6 6H22L20 14H8L6 6Z" stroke="url(#gold)" stroke-width="1.8" fill="none"/>
          <circle cx="9" cy="20" r="1.5" fill="url(#gold)"/>
          <circle cx="18" cy="20" r="1.5" fill="url(#gold)"/>
          <defs>
            <linearGradient id="gold" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#f6edc7"/>
              <stop offset="50%" stop-color="#c9a23a"/>
              <stop offset="100%" stop-color="#7a6408"/>
            </linearGradient>
          </defs>
        </svg>
        مشاهده
      </a></div>
      <div class="item"><span>اطلاعات حساب</span><button>ویرایش</button></div>
      <div class="item"><span>پشتیبانی رسمی</span><button>تماس</button></div>
    </div>


    <div class="footer">ASIAGOLD فروشنده نیست و در این پلتفرم هیچ پرداختی دریافت نمی‌شود</div>
</div>
</div>
<script>
(() => {
  const titleEl = document.getElementById("ag-topbar-title");
  const source = document.querySelector(".title");
  if (titleEl) titleEl.textContent = (source?.textContent || "").trim() || document.title.split("|").pop().trim();

  const backBtn = document.querySelector(".ag-back");
  if (backBtn) {
    const fallback = backBtn.getAttribute("data-fallback") || "./user-dashboard.html";
    backBtn.addEventListener("click", () => {
      if (window.history.length >= 2) window.history.back();
      else window.location.href = fallback;
    });
  }

  const catalogList = document.getElementById("catalog-list");
  const catalogBreadcrumb = document.getElementById("catalog-breadcrumb");
  const catalogBack = document.getElementById("catalog-back");
  if (!catalogList || !catalogBreadcrumb || !catalogBack) return;

  const CATALOG = [
    {
      id: "cat-bangle",
      name: "النگو",
      desc: "مشاهده گروه‌های این دسته‌بندی",
      groups: [
        {
          id: "grp-bangle-asia",
          name: "النگو آسیا",
          desc: "مشاهده مدل‌های این گروه",
          models: [
            { id: "mdl-bangle-asia-120-yellow", name: "النگو آسیا 120 زرد", desc: "جزئیات در مرحله بعد فعال می‌شود" },
            { id: "mdl-bangle-asia-155-yellow", name: "النگو آسیا 155 زرد", desc: "جزئیات در مرحله بعد فعال می‌شود" },
          ],
        },
      ],
    },
    {
      id: "cat-khorderiz",
      name: "خرده ریز",
      desc: "مشاهده گروه‌های این دسته‌بندی",
      groups: [
        {
          id: "grp-khorderiz-earring",
          name: "گوشواره",
          desc: "مشاهده مدل‌های این گروه",
          models: [
            { id: "mdl-earring-yellow-fantasy", name: "گوشواره زرد فانتزی", desc: "جزئیات در مرحله بعد فعال می‌شود" },
            { id: "mdl-earring-white-simple", name: "گوشواره سفید ساده", desc: "جزئیات در مرحله بعد فعال می‌شود" },
          ],
        },
      ],
    },
  ];

  const state = {
    level: "category", // category | group | model
    categoryId: null,
    groupId: null,
  };

  function escapeHtml(s) {
    return String(s)
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  function thumbFor(name) {
    const t = String(name || "").trim();
    return t ? t.slice(0, 1) : "•";
  }

  function renderList(items, onClick) {
    catalogList.innerHTML = "";
    for (const it of items) {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "catalog-item";
      btn.innerHTML =
        `<div class="catalog-thumb" aria-hidden="true">${escapeHtml(thumbFor(it.name))}</div>` +
        `<div class="catalog-text">` +
        `<div class="catalog-name">${escapeHtml(it.name)}</div>` +
        `<div class="catalog-desc">${escapeHtml(it.desc || "")}</div>` +
        `</div>`;
      btn.addEventListener("click", () => onClick(it));
      catalogList.appendChild(btn);
    }
  }

  function findCategory(id) {
    return CATALOG.find((c) => c.id === id) || null;
  }

  function findGroup(category, id) {
    if (!category) return null;
    return (category.groups || []).find((g) => g.id === id) || null;
  }

  function renderBreadcrumb() {
    if (state.level === "category") {
      catalogBreadcrumb.textContent = "برای شروع، یک «دسته‌بندی» را انتخاب کنید.";
      catalogBack.hidden = true;
      return;
    }

    const cat = state.categoryId ? findCategory(state.categoryId) : null;
    if (state.level === "group") {
      catalogBreadcrumb.textContent = `دسته‌بندی: ${cat?.name || "—"} / انتخاب «گروه»`;
      catalogBack.hidden = false;
      return;
    }

    const grp = state.groupId ? findGroup(cat, state.groupId) : null;
    catalogBreadcrumb.textContent = `دسته‌بندی: ${cat?.name || "—"} / گروه: ${grp?.name || "—"} / انتخاب «مدل»`;
    catalogBack.hidden = false;
  }

  function renderCatalog() {
    renderBreadcrumb();
    if (state.level === "category") {
      renderList(
        CATALOG.map((c) => ({ id: c.id, name: c.name, desc: c.desc })),
        (cat) => {
          state.level = "group";
          state.categoryId = cat.id;
          state.groupId = null;
          renderCatalog();
        }
      );
      return;
    }

    if (state.level === "group") {
      const category = state.categoryId ? findCategory(state.categoryId) : null;
      const groups = (category?.groups || []).map((g) => ({ id: g.id, name: g.name, desc: g.desc }));
      renderList(groups, (grp) => {
        state.level = "model";
        state.groupId = grp.id;
        renderCatalog();
      });
      return;
    }

    const category = state.categoryId ? findCategory(state.categoryId) : null;
    const group = state.groupId ? findGroup(category, state.groupId) : null;
    const models = (group?.models || []).map((m) => ({ id: m.id, name: m.name, desc: m.desc }));
    renderList(models, (model) => {
      if (state.categoryId === "cat-bangle" || state.categoryId === "cat-khorderiz") {
        try {
          history.replaceState(null, "", `#cat=${state.categoryId}&level=group`);
        } catch (e) {}
        const params = new URLSearchParams();
        params.set("cat", state.categoryId);
        if (state.groupId) params.set("group", state.groupId);
        params.set("model", model.id);
        window.location.href = `./user-orders.html?${params.toString()}`;
        return;
      }
      window.alert("جزئیات محصول در مرحله بعد فعال می‌شود");
    });
  }

  catalogBack.addEventListener("click", () => {
    if (state.level === "model") {
      state.level = "group";
      state.groupId = null;
      renderCatalog();
      return;
    }
    state.level = "category";
    state.categoryId = null;
    state.groupId = null;
    renderCatalog();
  });

  (() => {
    const raw = (window.location.hash || "").replace(/^#/, "");
    if (!raw) return;
    const params = new URLSearchParams(raw);
    const cat = params.get("cat");
    const level = params.get("level");
    const grp = params.get("group");
    const catObj = cat ? findCategory(cat) : null;
    if (!catObj) return;

    if (level === "model") {
      const grpObj = grp ? findGroup(catObj, grp) : null;
      state.level = grpObj ? "model" : "group";
      state.categoryId = cat;
      state.groupId = grpObj ? grp : null;
      return;
    }

    if (level === "group") {
      state.level = "group";
      state.categoryId = cat;
      state.groupId = null;
    }
  })();

  renderCatalog();
})();
</script>
</body>
</html>
