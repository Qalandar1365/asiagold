<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AsiaGold</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
/* ===== Page Background ===== */
body {
  margin: 0;
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(180deg,#ffffff 0%, #f7e7b5 100%);
  color: #020617;
}

/* ===== Center Wrapper ===== */
.wrapper {
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

/* ===== Card ===== */
.card {
  width: 100%;
  max-width: 420px;
  background: linear-gradient(180deg,#0b1f44,#071733);
  border-radius: 28px;
  padding: 28px 22px 32px;
  box-shadow: 0 30px 60px rgba(0,0,0,.35);
}

/* ===== Logo Placeholder ===== */
.logo {
  width: 110px;
  height: 110px;
  margin: 0 auto 18px;
  border-radius: 50%;
  background: linear-gradient(135deg,#1e90ff,#00c6ff);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: bold;
  font-size: 14px;
}

/* ===== Inputs ===== */
input {
  width: 100%;
  padding: 16px;
  margin-top: 14px;
  border-radius: 18px;
  border: none;
  font-size: 15px;
  outline: none;
  background: #ffffff;
}

/* ===== Rules ===== */
.rules {
  margin-top: 18px;
  font-size: 14px;
  color: #e5e7eb;
  line-height: 1.9;
}

/* ===== Checkbox ===== */
.checkbox {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 18px;
  font-size: 14px;
  color: #ffffff;
}

/* ===== Button ===== */
button {
  width: 100%;
  margin-top: 26px;
  padding: 16px;
  border-radius: 22px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  border: none;
  background: linear-gradient(135deg,#3bb3ff,#1e88ff);
  color: #ffffff;
  box-shadow: 0 10px 25px rgba(30,136,255,.45);
}

button:disabled {
  opacity: .5;
  box-shadow: none;
  cursor: not-allowed;
}
</style>
</head>

<body>
<div class="wrapper">
  <div class="card" id="app">Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„â€¦</div>
</div>

<script>
(() => {
const tg = Telegram.WebApp;
const WORKER = "https://asiagold-api.qalandar65.workers.dev";
const app = document.getElementById("app");

tg.ready();
tg.expand();

let state = {
  first: "",
  last: "",
  accepted: false
};

function check() {
  document.getElementById("submit").disabled = !(
    state.first &&
    state.last &&
    state.accepted
  );
}

async function start() {
  const r = await fetch(WORKER,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ initData: tg.initData })
  });
  const j = await r.json();

  if (j.ok && j.registered) {
    renderPassed();
  } else {
    renderRegister();
  }
}

function renderRegister() {
  app.innerHTML = `
    <div class="logo">ASIA<br>GOLD</div>

    <input id="first" placeholder="Ù†Ø§Ù…">
    <input id="last" placeholder="Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">

    <div class="rules">
      â€¢ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ ÙÙ‚Ø· Ù¾Ø³ Ø§Ø² ØªØ£ÛŒÛŒØ¯ Ù…Ø¯ÛŒØ± ÙØ±ÙˆØ´ Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.<br>
      â€¢ Ù…Ø³Ø¦ÙˆÙ„ÛŒØª ØµØ­Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø± Ø¹Ù‡Ø¯Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø§Ø³Øª.<br>
      â€¢ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§ Ù…Ø­Ø±Ù…Ø§Ù†Ù‡ Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯.<br>
      â€¢ Ù‡Ø± Ø­Ø³Ø§Ø¨ ÙÙ‚Ø· Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ ÛŒÚ© Ø´Ø®Øµ Ø§Ø³Øª.
    </div>

    <div class="checkbox">
      <input type="checkbox" id="rulesCheck">
      <label>Ø´Ø±Ø§ÛŒØ· Ùˆ Ù‚ÙˆØ§Ù†ÛŒÙ† Ø±Ø§ Ù…ÛŒâ€ŒÙ¾Ø°ÛŒØ±Ù…</label>
    </div>

    <button id="submit" disabled>Ø«Ø¨Øª Ù†Ø§Ù…</button>
  `;

  document.getElementById("first").oninput = e => {
    state.first = e.target.value.trim(); check();
  };
  document.getElementById("last").oninput = e => {
    state.last = e.target.value.trim(); check();
  };
  document.getElementById("rulesCheck").onchange = e => {
    state.accepted = e.target.checked; check();
  };

  document.getElementById("submit").onclick = async () => {
    await fetch(WORKER,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({
        initData: tg.initData,
        profile: state,
        action: "temp_register"
      })
    });
    renderPending();
  };
}

function renderPending() {
  app.innerHTML = `
    <div class="logo">âœ“</div>
    <div class="rules" style="text-align:center">
      Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.<br>
      Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒØ´ÙˆÛŒØ¯.
    </div>
  `;
}

function renderPassed() {
  app.innerHTML = `
    <div class="logo">âœ“</div>
    <div class="rules" style="text-align:center">
      Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ğŸŒŸ<br>
      ÙˆØ§Ø±Ø¯ Ø³Ø§Ù…Ø§Ù†Ù‡ Ø´Ø¯ÛŒØ¯.
    </div>
  `;
}

start();
})();
</script>
</body>
</html>
